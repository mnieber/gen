{% magic_with myItem = __item_name %}


{% section imports %}
import { MyItemT } from 'src/api/types/MyItemT';
import {
    useSelectionUIConnector,                                                                  {% ?? bvrs_has_selection %}
    useDragAndDropUIConnector,                                                                {% ?? bvrs_has_drag_and_drop %}
} from 'skandha-mobx/hooks';
import { createOnSelectItemHandler } from 'src/routes/utils';                                 {% ?? update_url %}
import { useMenuHandler } from 'src/frames/hooks/useMenuHandler';                             {% ?? context_menu %}
{% end_section %}


{% section props %}
    updateUrl?: (myItem: MyItemT) => void;                                                    {% ?? update_url %}
{% end_section %}


{% section preamble_hooks %}
const menuHandler = useMenuHandler();                                                         {% if context_menu %}
{{ "" }}                                                                                      {% endif %}
const dragAndDropUIConnector = useDragAndDropUIConnector(                                     {% if bvrs_has_drag_and_drop %}
    props.myItemsDragAndDrop
);                                                                                            {% endif %}
const selectionUIConnector = useSelectionUIConnector(                                         {% if bvrs_has_selection %}
    props.myItemsSelection,
    {                                                                                         {% if update_url %}
      onSelectItem: createOnSelectItemHandler(props.myItems, props.updateUrl),
    },
    [props.myItems, props.updateUrl]                                                          {% endif %}
);                                                                                            {% endif %}
{{ "" }}
{% end_section %}


{% section preamble %}
const noItems = <h2>There are no myItems</h2>;

const myItemDivs = {{ __items_expr }}.map((myItem{% if context_menu %}, idx{% endif %}) => {
  {{ child_widget_div }}
});
{{ "" }}

const menuDiv = UIkit && (                                                                    {% if context_menu %}
  <div key="menu" ref={menuHandler.ref} data-uk-dropdown="mode:click">
  {# Moonleap Todo #}
  </div>
);                                                                                            {% endif %}

{% end_section %}


{% section lines %}
{clipDivs.length > 0 && menuHandler.insertMenuDiv(clipDivs, menuDiv)}                         {% ?? context_menu %}
{myItemDivs.length > 0 && myItemDivs}                                                         {% ?? not context_menu %}
{myItemDivs.length === 0 && noItems}
{% end_section %}
