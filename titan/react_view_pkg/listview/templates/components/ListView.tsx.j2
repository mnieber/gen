{% magic_with _.component.item_name as myItem %}
{% magic_with _.component.name as MyListView %}
{% magic_with _.component.module.name as myReactModule %}
import { cn } from 'src/utils/classnames';
import * as R from 'ramda';
import { dragState } from 'skandha-facets/DragAndDrop';                                         {% ?? __.drag_and_drop_bvr %}
import { observer } from 'mobx-react-lite';
import { defaultProps as dps, withDefaultProps } from 'src/app/defaultProps';
import { MyItemListViewItem } from 'src/myReactModule/components/MyItemListViewItem';
import { MyItemT } from 'src/api/types/MyItemT';
import { getResourceView } from 'src/utils/components';
import { isLoaded } from 'src/api/loadingState';
import { Deletion } from 'skandha-facets/Deletion';                                             {% ?? __.deletion_bvr %}
import { Highlight } from 'skandha-facets/Highlight';                                           {% ?? __.selection_bvr %}
import { Selection } from 'skandha-facets/Selection';                                           {% if __.selection_bvr %}
import { ClickToSelectItems } from 'skandha-facets/handlers';                                   {% endif %}
import UIkit from 'uikit';
import './MyItemListView.scss';

type PropsT = {
  className?: any;
};

const DefaultProps = {
  ...dps.myItems,
  ...dps.myItemsDeletion,                                                                      {% ?? __.deletion_bvr %}
  ...dps.myItemsDragAndDrop,                                                                   {% ?? __.drag_and_drop_bvr %}
  ...dps.myItemsHighlight,                                                                     {% ?? __.selection_bvr %}
  ...dps.myItemsSelection,                                                                     {% ?? __.selection_bvr %}
};

export const MyListView = observer(
  withDefaultProps((props: PropsT & typeof DefaultProps) => {
    if (!isLoaded(props.myItems)) {
      return UIkit && <div data-uk-spinner className=""></div>;                                 {% ?? _.service.uikit %}
      return null;                                                                              {% ?? not _.service.uikit %}
    }

    const handleClick = new ClickToSelectItems({                                                {% if __.selection_bvr %}
      selection: props.myItemsSelection
    });                                                                                         {% endif %}

    const myItemDivs = R.pipe(
      R.always(props.myItems),
      R.map((myItem: MyItemT) => {
        return (
          <MyListViewItem
            key={myItem.id}
            myItem={myItem}
            isSelected={myItem && props.myItemsSelection.ids.includes(myItem.id)}            {% ?? __.selection_bvr %}
            isHighlighted={myItem && props.myItemsHighlight.id === myItem.id}                {% ?? __.selection_bvr %}
            dragState={dragState(props.myItemsDragAndDrop.hoverPosition, myItem.id)}          {% ?? __.drag_and_drop_bvr %}
            onDelete={() => props.myItemsDeletion.delete([myItem.id])}                        {% ?? __.deletion_bvr %}
            {...handleClick.handle(myItem.id)}                                                 {% ?? __.selection_bvr %}
            {...props.myItemsDragAndDrop.handle(myItem.id)}                                   {% ?? __.drag_and_drop_bvr %}
          />
        );
      })
    )();

    const noItems = <h2>There are no myItems</h2>;

    return (
      <div
        className={cn(
          'MyItemListView', 'flex flex-col',
          props.className
        )}
      >
        {myItemDivs.length > 0 && myItemDivs}
        {myItemDivs.length === 0 && noItems}
      </div>
    );
  }, DefaultProps)
);
{% end_magic_with %}
{% end_magic_with %}
{% end_magic_with %}
