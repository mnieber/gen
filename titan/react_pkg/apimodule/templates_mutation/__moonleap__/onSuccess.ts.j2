{% magic_with order_parent as MyOrderParent %}
{% magic_with order_child as myOrderChild %}
{% magic_with order_ids as myOrderIds %}
{% magic_with api_spec.name as myEndpoint %}
{% magic_with updatePath as myUpdatePath %}
    onMutate: (args: ArgsT) => {                                                                            {% if _.mutation.api_spec.orders %}
      const updateMyOrderParent = (myOrderParent: MyOrderParentT) => {                                      {% for order_parent, order_child, order_ids, order_api_specs in __.orders_data %}
        return R.isNil(myOrderParent.myOrderChild)
          ? myOrderParent
          : {
              ...myOrderParent,
              myOrderChild: sortByIds(myOrderParent.myOrderChild, args.myOrderIds),
            };
      };
      queryClient.setQueriesData(                                                                           {% for api_spec, updatePaths in order_api_specs %}
        { queryKey: ['myEndpoint'] },
        (data: any) => {
          return applyUpdate(
            [
              'myUpdatePath',                                                                               {% !! updatePath in updatePaths %}
            ],
            data,
            updateMyOrderParent
          );
        }
      );                                                                                                   {% endfor %}{% endfor %}
    },                                                                                                      {% endif %}
    onSuccess: (response: ObjT) => {                                                                        {% min_lines count=5 %}
      response.myOutputFieldName = hydrateMyOutputFieldType(response.myOutputFieldName);                    {% if __.hydrated_fields %}{% for output_field_spec in __.hydrated_fields %}{% ?? output_field_spec.field_type == "fk" %}
      response.myOutputFieldName = R.map(hydrateMyOutputFieldType, response.myOutputFieldName);             {% ?? output_field_spec.field_type == "relatedSet" %}{% endfor %}{% endif %}

      queryClient.invalidateQueries(                                                                        {% if _.mutation.api_spec.invalidates %}
        {
          queryKey: [
            '{{ queryName }}',                                                                              {% !! queryName in _.mutation.api_spec.invalidates %}
            {% remove_trailing suffix="," %}
          ]
        }
      );                                                                                                    {% endif %}
    },                                                                                                      {% end_min_lines %}
{% end_magic_with %}
{% end_magic_with %}
{% end_magic_with %}
{% end_magic_with %}
{% end_magic_with %}
