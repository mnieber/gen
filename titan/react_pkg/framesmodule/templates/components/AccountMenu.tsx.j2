import { observer } from 'mobx-react-lite';
import React from 'react';
import { useLoadUserId, useSignOut } from 'src/auth/api';
import { SignInLi } from 'src/auth/components/SignInLi';                                        {% ?? _.service.react_app.auth_module %}
import { SignOutLi } from 'src/auth/components/SignOutLi';                                      {% ?? _.service.react_app.auth_module %}
import { button } from 'src/frames/components';
import { useMenuRef } from 'src/frames/hooks/useMenuRef';
import { cn } from 'src/utils/classnames';

import './AccountMenu.scss';

export const AccountMenu = observer(() => {
  const loadUserId = useLoadUserId();
  const menuRef = useMenuRef();

  return (
    <div className={cn('AccountMenu', 'uk-inline')}>
      <button
        data-cy="accountMenu"
        className={button}
        type="button"
      >
        Account
      </button>
      <div
        ref={menuRef.ref}
      >
        <ul className="uk-nav uk-dropdown-nav">
          {!loadUserId.data?.isAuthenticated && <SignInLi menuRef={menuRef} />}                 {% ?? _.service.react_app.auth_module %}
          {loadUserId.data?.isAuthenticated && <SignOutLi menuRef={menuRef} />}                 {% ?? _.service.react_app.auth_module %}
        </ul>
      </div>
    </div>
  );
});
