{% trim_newlines keep=1 %}
{% magic_with item_list.item_name as yellowTulip %}
{% magic_with item.name as blueDaisy %}
{% magic_with res.module.name as gardenFlowers %}
import { action, observable, makeObservable } from 'mobx';
import { forEach } from 'lodash/fp';
import { RST, resetRS, updateRes } from 'src/utils/RST';
import * as gardenFlowersApi from 'src/gardenFlowers/api';

{% for item in res.items %}
import { BlueDaisyT } from 'src/gardenFlowers/types';
{% endfor %}
{% for item_list in res.item_lists %}
import { YellowTulipT, YellowTulipByIdT } from 'src/gardenFlowers/types';
{% endfor %}

export class {{ res.name }} {
{% for item_list in res.item_lists %}
  @observable yellowTulipById: YellowTulipByIdT = {};
  @observable yellowTulipByIdRS: RST = resetRS();
{% endfor %}
{% for item in res.items %}
  @observable blueDaisy?: BlueDaisyT = undefined;
  @observable blueDaisyRS: RST = resetRS();
{% endfor %}

  constructor() {
    makeObservable(this);
  }

{% for item_list in res.item_lists %}
  @action addYellowTulips = (yellowTulips: YellowTulipT[]) => {
    forEach((yellowTulip: YellowTulipT) => {
      this.yellowTulipById[yellowTulip.id] = yellowTulip;
    }, yellowTulips);
  }
{% endfor %}

{% for item in res.items %}
  @action loadBlueDaisy = () => {
    updateRes(
      this,
      'blueDaisyRS',
      () => {
        return gardenFlowersApi.getBlueDaisy();
      },
      (response: any) => {
        this.blueDaisy = response.blueDaisy;
      },
      (message: any) => {
        console.log(message);
        return 'Oops, there was an error getting the blueDaisy data';
      }
    );
  }

  @action saveBlueDaisy = (values: any) => {
    gardenFlowersApi.saveBlueDaisy(values);
  }
{% endfor %}

{% for item_list in res.item_lists %}
  @action loadYellowTulips = () => {
    updateRes(
      this,
      'yellowTulipByIdRS',
      () => {
        return gardenFlowersApi.getYellowTulips();
      },
      (response: any) => {
        this.addYellowTulips(response.yellowTulips);
      },
      (message: any) => {
        console.log(message);
        return 'Oops, there was an error getting the yellowTulips data';
      }
    );
  }

  @action saveYellowTulip = (values: any) => {
    gardenFlowersApi.saveYellowTulip(values);
  }
{% endfor %}

}
{% end_magic_with %}
{% end_magic_with %}
{% end_magic_with %}
{% end_trim_newlines %}